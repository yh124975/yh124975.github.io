window.__require=function t(i,s,e){function n(c,h){if(!s[c]){if(!i[c]){var a=c.split("/");if(a=a[a.length-1],!i[a]){var r="function"==typeof __require&&__require;if(!h&&r)return r(a,!0);if(o)return o(a,!0);throw new Error("Cannot find module '"+c+"'")}}var l=s[c]={exports:{}};i[c][0].call(l.exports,function(t){return n(i[c][1][t]||t)},l,l.exports,t,i,s,e)}return s[c].exports}for(var o="function"==typeof __require&&__require,c=0;c<e.length;c++)n(e[c]);return n}({attribute:[function(t,i,s){"use strict";cc._RF.push(i,"c2a47EvNvVPhbOxdLKxD+ax","attribute"),cc.Class({extends:cc.Component,properties:{},btncancelClick:function(t,i){t.target.parent.active=!1},getHeroAtt:function(){var t=this.node.children;t[0].getComponent(cc.Label).string=this.Hero.HP,t[1].getComponent(cc.Label).string=this.Hero.MP,t[2].getComponent(cc.Label).string=this.Hero.ATK,t[3].getComponent(cc.Label).string=this.Hero.DEF,t[4].getComponent(cc.Label).string=this.Hero.EXP,t[5].getComponent(cc.Label).string=this.Hero.speedx,t[6].getComponent(cc.Label).string=this.Hero.ACC,t[7].getComponent(cc.Label).string=this.Hero.CRT,t[8].getComponent(cc.Label).string=this.Hero.AVD},start:function(){this.hero=cc.find("Canvas/hero"),this.Hero=this.hero.getComponent("hero"),this.getHeroAtt()},update:function(t){this.getHeroAtt()}}),cc._RF.pop()},{}],backpack:[function(require,module,exports){"use strict";cc._RF.push(module,"056be4xppFGAJnyrQfPgFOn","backpack"),cc.Class({extends:cc.Component,properties:{item_ui:cc.Node,item_layout:cc.Node,item_info_ui:cc.Node,discard_ui:cc.Node,error_ui:cc.Node,gold:cc.Label,trade_ui:cc.Node,equip:cc.Node},onLoad:function(){this.G=cc.find("Canvas/global").getComponent("global"),this.root=cc.find("root").getComponent("root"),this.city=cc.find("Canvas").getComponent("city"),this.hero=cc.find("Canvas/hero"),this.Hero=this.hero.getComponent("hero"),this.item_ui.active=!1,this.Equip=this.equip.getComponent("equip")},start:function start(){this.npc_json=[],this.item_json=this.Hero.json,this.item_list=eval(this.item_json),this.input_nu=cc.EditBox,this.input_nu=this.discard_ui.children[1],this.item=null,this.item_lock=!1,this.items=new Array,this.item_pool=new Array,this.gold.string=this.Hero.GOLD,this.equip_json=this.Hero.equip_json,this.backpackTest(),this.getNpcjson()},getNpcjson:function(){null==this.root.getJson("attri_json")?(console.log("backpack get npc_json from city"),this.npc_json=this.city.npc_json):(console.log("backpack get npc_json from root"),this.npc_json=this.root.getJson("npc_json"))},insItem:function(){for(var t in this.prefabArr)this.items[t]=cc.instantiate(this.prefabArr[t]),console.log("prefab item:"+this.items[t].name.trim());for(var t in this.Hero.items=this.items,this.Hero.items)console.log("hero items ["+t+"]:"+this.Hero.items[t].name)},backpackTest:function backpackTest(){for(var i in this.item_layout.removeAllChildren(),this.gold.string=this.Hero.GOLD,this.item_list=eval(this.Hero.json),this.item_list){var item_name=this.item_list[i].name.trim(),node=this.G.getItem(item_name);this.item_layout.addChild(node),node.on("click",this.itemClick,this)}},btncancelClick:function(t){var i=t.target;i.parent==this.node&&(this.item_ui.active=!1,this.discard_ui.active=!1,this.item_info_ui.active=!1),i.parent.active=!1},itemClick:function(t){this.item=t.target;var i=this.item.name;console.log(i+"has been clicked"),this.item_ui.active=!0,this.item_ui.zIndex=998,this.item_ui.setPosition(cc.v2(this.item.x-100,this.item.y+90))},itemuiClick:function(t){var i=t.target.name.trim();if("btn1"==i){for(var s in console.log("itemui->btn1 click"),this.item_info_ui.active=!0,this.item_info_ui.zIndex=this.item_ui.zIndex+1,this.item_info_ui.children[1].getComponent(cc.Sprite).spriteFrame=this.item.getComponent(cc.Sprite).spriteFrame,this.item_info_ui.children[2].getComponent(cc.Label).string=this.item.children[0].getComponent(cc.Label).string,console.log("this.item.children[0].string:"+this.item.children[0].getComponent(cc.Label).string),this.item_list)if(this.item_list[s].name.trim()==this.item.name.trim()){this.item_info_ui.children[3].getComponent(cc.Label).string="\u6570\u91cf\uff1a"+this.item_list[s].nu;break}this.item_info_ui.children[4].getComponent(cc.Label).string=this.item.children[1].getComponent(cc.Label).string}else if("btn3"==i){var e;for(var s in this.item_list)if(this.item_list[s].name.trim()==this.item.name.trim()){this.discard_ui.children[3].getComponent(cc.Label).string="\u62e5\u6709:"+this.item_list[s].nu,e=this.item_list[s].nu;break}if(1==e){for(var s in this.item_json)this.item_json[s].name==this.item.name.trim()&&(this.item_json.splice(s,1),console.log("drop the item:"+this.item.name));for(var s in this.item_json)console.log(" the itemlist:"+this.item_json[s].name);this.G.putItem(this.item),this.item_ui.active=!1}else this.discard_ui.active=!0,this.input_nu.getComponent(cc.EditBox).string="",this.item_ui.active=!1}else this.itemUse(this.item)},discardBtnClick:function(t,i){var s=this.discard_ui.children[3].getComponent(cc.Label).string.split(":")[1],e=this.input_nu.getComponent(cc.EditBox).string;if(console.log("---input & max :"+Number(e)+"   "+Number(s)),Number(e))if((e=Number(e))<=(s=Number(s))){for(var n in console.log("drop success"),t.target.parent.active=!1,this.item_json)if(this.item_json[n].name.trim()==this.item.name.trim()){s==e?(this.item_json.splice(n,1),this.item.active=!1):this.item_json[n].nu=s-e;break}for(var n in this.item_json)console.log("item json:"+this.item_json[n].name+"  "+this.item_json[n].nu),console.log("------drop i:"+n)}else this.errDisplay("\u8d85\u8fc7\u6700\u5927\u6570\u91cf");else console.log("drop error"),this.errDisplay("\u8bf7\u8f93\u5165\u6570\u5b57")},itemUse:function(t){var i=t.name.trim().split("m");i=Number(i[1]),console.log("item id:"+i);var s=!1,e="";switch(i){case 0:s=!0,this.Hero.HP+=10;break;case 1:case 2:case 3:this.errDisplay("\u8be5\u7269\u54c1\u65e0\u6cd5\u4f7f\u7528\uff0c\u53ea\u80fd\u4ea4\u6613");break;case 4:s=!0,this.Hero.HP+=5,this.Hero.MP+=5;break;case 5:s=!0,this.Hero.HP+=10,this.Hero.MP+=10;break;case 6:s=!0,this.Hero.HP+=30;break;case 7:s=!0,this.Hero.MP+=30;break;case 8:s=!0,this.Hero.HP+=30;break;case 9:this.errDisplay("\u4ef7\u503c\u4e0d\u83f2");break;case 10:case 11:this.errDisplay("\u8be5\u7269\u54c1\u65e0\u6cd5\u4f7f\u7528\uff0c\u53ea\u80fd\u4ea4\u6613");break;case 20:s=!0,e="head",this.itemEquip(t,e,"10");break;case 21:s=!0,e="head",this.itemEquip(t,e,"20");break;case 22:e="head",s=!0,this.itemEquip(t,e,"50");break;case 23:e="hand",s=!0,this.itemEquip(t,e,"10");break;case 24:e="hand",s=!0,this.itemEquip(t,e,"20");break;case 25:e="hand",s=!0,this.itemEquip(t,e,"30");break;case 26:e="weapon",s=!0,this.itemEquip(t,e,"10");break;case 27:e="weapon",s=!0,this.itemEquip(t,e,"20");break;case 28:e="weapon",s=!0,this.itemEquip(t,e,"30");break;case 29:e="body",s=!0,this.itemEquip(t,e,"10");break;case 30:e="body",s=!0,this.itemEquip(t,e,"20");break;case 31:e="body",s=!0,this.itemEquip(t,e,"50")}s&&this.itemnuDecrease(t,this.item_json)},itemEquip:function(t,i,s){var e=0;this.equip.active=!0;for(e=0;e<this.equip_json.length;e++)if(this.equip_json[e].part==i){"weapon"==i?this.errDisplay("\u88c5\u5907\u66ff\u6362\u6210\u529f\uff01\u653b\u51fb\u529b+"+s):this.errDisplay("\u88c5\u5907\u66ff\u6362\u6210\u529f\uff01\u9632\u5fa1\u529b+"+s);for(var n=this.equip_json[e].name,o=0;o<this.item_json.length;o++)if(this.item_json[o].name==n){var c=Number(this.item_json[o].nu)+1;this.item_json[o].nu=c;break}if(o>=this.item_json.length){var h={name:n,nu:"1"};this.item_json.push(h)}this.equip_json[e].name=t.name.trim(),this.equip_json[e].effect=s;break}if(e>=this.equip_json.length){"weapon"==i?this.errDisplay("\u88c5\u5907\u6210\u529f\uff01\u653b\u51fb\u529b+"+s):this.errDisplay("\u88c5\u5907\u6210\u529f\uff01\u9632\u5fa1\u529b+"+s);var a={name:t.name,part:i,effect:s};this.equip_json.push(a)}this.equip.y=0,this.Equip.start()},itemnuDecrease:function(t,i){for(var s in i)if(i[s].name==t.name.trim()){var e=Number(i[s].nu)-1;e<=0?(i.splice(s,1),this.item_ui.active=!1,this.backpackTest(),console.log("pack has no this item :"+t.name)):i[s].nu=e;break}},btntradeSet:function(t){this.item_ui.children[3].active=!0,this.item_ui.children[3].on("click",this.btntradeClick,this)},btntradeClick:function(){this.item_ui.active=!1,this.trade_ui.active=!0,this.trade_ui.children[1].getComponent(cc.EditBox).string="";var t=this.trade_ui.children[3].getComponent(cc.Label);for(var i in this.item_json)if(this.item_json[i].name==this.item.name.trim()){t.string="\u62e5\u6709:"+this.item_json[i].nu;break}},errDisplay:function(t){this.error_ui.active=!0,this.error_ui.zIndex=999,this.error_ui.children[0].getComponent(cc.Label).string=t},btntradeOkClick:function(){this.trade_ui.active=!1;var t,i=this.item,s=this.item_json,e=this.trade_ui.children[1].children[1].getComponent(cc.Label);if(Number(e.string)){t=Number(e.string),console.log("input nu:"+t);var n=0;for(var o in this.npc_json){var c=this.npc_json[o].item;for(var h in c)if(i.name.trim()==c[h].name.trim()){n=Number(c[h].unit),console.log("unit:"+n);break}if(0!=n)break}for(var o in s)if(s[o].name==i.name.trim()){var a=Number(s[o].nu),r=Number(this.Hero.GOLD);if(t<a)a-=t,r+=t*n,s[o].nu=a;else{if(t!=a)return void this.errDisplay("\u8d85\u8fc7\u62e5\u6709\u6570\u91cf");r+=t*n,this.item_json.splice(o,1),console.log("pack has no this item \uff1a"+i.name)}this.Hero.GOLD=r,this.backpackTest(),this.errDisplay("\u83b7\u5f97 "+t*n+" \u91d1\u5e01");break}}else this.errDisplay("\u8bf7\u8f93\u5165\u6570\u5b57")},addItem:function(t,i){var s={name:t.name.trim(),nu:i};this.item_json.push(s)},update:function update(dt){this.item_json=this.Hero.json,this.item_list=eval(this.item_json)}}),cc._RF.pop()},{}],city:[function(t,i,s){"use strict";cc._RF.push(i,"e0c27QECEZPsKVXGgd9ntQ4","city"),cc.Class({extends:cc.Component,properties:{camera:cc.Node,hero:cc.Node,bg:cc.Node,map:cc.Node,npc_ui:cc.Node,npc_dialog:cc.Node,npclist:{default:[],type:cc.Node},hero_ui_pre:cc.Prefab,backpack:cc.Node,mission:cc.Node,attribute:cc.Node,shop:cc.Node,npc_mission:cc.Node,btn_music:cc.AudioClip},onLoad:function(){this.G=cc.find("Canvas/global").getComponent("global"),this.Hero=this.hero.getComponent("hero"),this.herohp=cc.instantiate(this.hero_ui_pre),this.node.addChild(this.herohp),this.hp=this.herohp.getChildByName("hp"),this.mp=this.herohp.getChildByName("mp"),this.Hero.hp_show=this.hp,this.Hero.mp_show=this.mp,this.Shop=this.shop.getComponent("shop"),this.Backpack=this.backpack.getComponent("backpack"),this.equip=cc.find("Canvas/equip"),this.Mission=this.mission.getComponent("mission"),this.Npc_mission=this.npc_mission.getComponent("npc_mission"),this.root=cc.find("root").getComponent("root")},start:function(){cc.director.preloadScene("transform"),this.shop_show=!1,this.npc_json=null,this.npc_item=new Array,this.npc=cc.Node,this.npc_dialog_lock=!1,this.mis_json=[],this.jsonCreate(),this.getMiss()},onDestroy:function(){},npcClick:function(t){this.npc=t.target.parent,this.npc_ui.active=!0,this.npc_ui.setPosition(cc.v2(this.npc.x+50,this.npc.y-40))},npcUiClick:function(t){this.btnMusicPlay();var i=t.target.name.trim();if(this.Shop.setValue("npc",this.npc.name.trim()),console.log("-----"+this.npc.name.trim()+"---\x3e"+i+" button clicked"),"talk"==i){this.npc_dialog.active=!0,this.npc_dialog_lock||(this.npc_dialog_lock=!0,this.schedule(function(){this.npc_dialog_lock=!1,this.npc_dialog.active=!1},3,1)),this.npc_dialog.setPosition(cc.v2(this.npc.x+80,this.npc.y+80));var s=this.npc.name.trim(),e=this.npc_dialog.children[0].getComponent(cc.Label);switch(s){case"npc0":e.string=this.npc_json[0].talk;break;case"npc1":e.string=this.npc_json[1].talk;break;case"npc2":e.string=this.npc_json[2].talk;break;case"npc3":e.string=this.npc_json[3].talk}}else"trade"==i?(this.npc_ui.active=!1,this.shop_show=!0,this.shop.active=!0,this.Shop.setValue("clear"),this.Shop.setItem(this.npc.name.trim()),this.Shop.setValue("head",this.npc.children[0].getComponent(cc.Sprite).spriteFrame),this.backpack.active=!0,this.backpack.zIndex=999,this.Backpack.start(),this.Backpack.btntradeSet(this.npc_json)):(this.npc_mission.active||(this.npc_mission.active=!0),this.Npc_mission.start(),this.missMonitor())},jsonCreate:function(){null==this.root.getJson("npc_json")?(console.log("create npc json"),this.npc_json=[{id:"0",talk:"\u60f3\u8981\u88c5\u5907\u5417\uff0c\u6211\u8fd9\u90fd\u6709",item:[{name:"item20",nu:"22",unit:"200"},{name:"item21",nu:"11",unit:"400"},{name:"item22",nu:"200",unit:"600"},{name:"item23",nu:"22",unit:"200"},{name:"item24",nu:"11",unit:"300"},{name:"item25",nu:"200",unit:"550"},{name:"item26",nu:"22",unit:"150"},{name:"item27",nu:"11",unit:"350"},{name:"item28",nu:"200",unit:"700"},{name:"item29",nu:"22",unit:"150"},{name:"item30",nu:"11",unit:"500"},{name:"item31",nu:"200",unit:"1000"}],mission:[{name:"mission0",title:"\u521d\u63a2\u6e56\u7554\u68ee\u6797",content:"\u51c6\u5907\u5145\u5206\u540e\uff0c\u4ece\u57ce\u9547\u5b88\u536b\u51fa\u524d\u5f80\u6e56\u7554\u68ee\u6797\uff0c\u5e76\u51ef\u65cb\u5f52\u6765",reward:[{name:"item0",nu:"1"},{name:"item3",nu:"2"}],state:"0",gold:"100"},{name:"mission1",title:"\u78e8\u5200\u4e0d\u8bef\u780d\u67f4\u5de5",content:"\u5728\u5546\u5e97\u8d2d\u4e705\u4e2a\u8349\u836f,\u5f00\u8d77\u5192\u9669\u4e4b\u65c5\u884c\u5427",reward:[{name:"item1",nu:"2"},{name:"item2",nu:"2"}],state:"0",gold:"200"},{name:"mission2",title:"\u5168\u526f\u6b66\u88c5",content:"\u88c5\u5907\u6240\u6709\u521d\u7ea7\u88c5\u5907",reward:[{name:"item8",nu:"1"}],state:"0",gold:"50"}]},{id:"1",talk:"\u836f\u5242,\u624d\u662f\u751f\u547d\u7684\u4fdd\u969c",item:[{name:"item0",nu:"22",unit:"10"},{name:"item4",nu:"200",unit:"20"},{name:"item5",nu:"200",unit:"35"},{name:"item6",nu:"200",unit:"60"},{name:"item7",nu:"200",unit:"80"},{name:"item8",nu:"200",unit:"80"},{name:"item9",nu:"200",unit:"9999"}],mission:[]},{id:"2",talk:"\u6211\u8fd9\u6709\u4e0d\u540c\u7684\u6750\u6599\u4f9b\u4f60\u9009\u62e9",item:[{name:"item1",nu:"22",unit:"20"},{name:"item2",nu:"22",unit:"50"},{name:"item3",nu:"111",unit:"30"},{name:"item10",nu:"111",unit:"50"},{name:"item11",nu:"200",unit:"20"}],mission:[]},{id:"3",talk:"\u60f3\u63a5\u4efb\u52a1\u5c31\u627e\u6211\u5427",item:[{name:"item9",nu:"200",unit:"9999"}],mission:[]}]):this.npc_json=this.root.getJson("npc_json")},onMouseDown:function(t){var i=t.getButton(),s=(t.getLocation(),t.target.name);switch(i){case cc.Event.EventMouse.BUTTON_LEFT:console.log("--------posi:"+s)}},loadTransform:function(){this.root.setJson(this.Hero,this.Mission,this);var t=this.root;t.getJson("hero_json"),t.getJson("mis_json"),t.getJson("equip_json"),t.getJson("npc_json")},PosiUpdate:function(){this.hero.x>0&&this.hero.x<1450&&(this.camera.x=this.hero.x),this.bg.x=this.camera.x,this.herohp.setPosition(cc.v2(this.camera.x,-280)),this.backpack.x=this.camera.x,this.equip.x=this.camera.x,this.mission.x=this.camera.x,this.npc_mission.x=this.camera.x,this.attribute.x=this.camera.x,this.shop_show&&(this.shop.x=this.camera.x-185,this.shop.active&&(this.backpack.x=this.camera.x+220)),this.equip.active&&this.backpack.active&&(this.equip.x=this.camera.x-185,this.backpack.x=this.camera.x+220)},btnMusicPlay:function(){cc.audioEngine.play(this.btn_music,!1,1)},getMiss:function(){for(var t in this.npc_json)for(var i in this.npc_json[t].mission)this.mis_json.push(this.npc_json[t].mission[i])},missMonitor:function(){for(var t in this.root.cur_lvl>=2&&"1"==this.mis_json[0].state&&(this.mis_json[0].state="2"),this.Hero.json)if("item0"==this.Hero.json[t].name&&Number(this.Hero.json[t].nu)>4){"1"==this.mis_json[1].state&&(this.mis_json[1].state="2");break}},update:function(t){this.PosiUpdate(),this.hero.x>1500&&(this.loadTransform(),cc.director.loadScene("transform"))}}),cc._RF.pop()},{}],endGame:[function(t,i,s){"use strict";cc._RF.push(i,"fd2e5ekdL9F5J69xIgWikTV","endGame"),cc.Class({extends:cc.Component,properties:{error_ui:cc.Node},onLoad:function(){this.canvas=cc.find("Canvas/Main Camera"),this.hero=cc.find("Canvas/hero")},start:function(){},btnEndClick:function(t){this.errDisplay("\u662f\u5426\u9000\u51fa\u6e38\u620f")},btnSaveClick:function(t,i){"ok"==i?cc.game.end():this.error_ui.active=!1},errDisplay:function(t){this.error_ui.active=!0,this.error_ui.zIndex=999,this.error_ui.children[0].getComponent(cc.Label).string=t},btncancelClick:function(t){t.target.parent.active=!1},update:function(t){this.hero.x<4500&&this.hero.x>0&&(this.node.x=this.canvas.x+900)}}),cc._RF.pop()},{}],equip:[function(t,i,s){"use strict";cc._RF.push(i,"bc6768gpR1NvI9M/9DkegF9","equip"),cc.Class({extends:cc.Component,properties:{equip_ui:cc.Node,hand:cc.Node,head:cc.Node,weapon:cc.Node,body:cc.Node,error_ui:cc.Node},onLoad:function(){this.global=cc.find("Canvas/global").getComponent("global"),this.Hero=cc.find("Canvas/hero").getComponent("hero"),this.Backpack=cc.find("Canvas/backpack").getComponent("backpack")},start:function(){this.cur_node=cc.Node,this.G=this.global,this.equip_json=this.Hero.equip_json,this.item_json=this.Hero.json,this.createEquip()},equipClick:function(t){this.cur_node=t.target,console.log("click equip:"+this.cur_node.name+" ]"),this.equip_ui.active=!0,this.equip_ui.parent=this.cur_node.parent,this.equip_ui.setPosition(cc.v2(this.cur_node.x+50,this.cur_node.y-60))},equipUiClick:function(t){if("btn0"==t.target.name.trim())this.errDisplay(this.cur_node.children[0].getComponent(cc.Label).string+"\n"+this.cur_node.children[1].getComponent(cc.Label).string);else{for(var i in this.equip_json)if(this.cur_node.name.trim()==this.equip_json[i].name){console.log("find the equip,then drop");var s=this.cur_node.name.trim(),e=Number(this.equip_json[i].effect),n=this.equip_json[i].part;console.log("----type:"+n),"weapon"==n?this.Hero.ATK-=e:this.Hero.DEF-=e,this.equip_json.splice(i,1);var o=0;for(o=0;o<this.item_json.length;o++)if(s==this.item_json[o].name){console.log("find the item in hero json");var c=this.item_json[o];c.nu=Number(c.nu)+1;break}if(o>=this.item_json.length){var h={name:s,nu:"1"};this.item_json.push(h)}break}this.errDisplay("\u88c5\u5907\u5df2\u653e\u5165\u80cc\u5305"),this.Backpack.node.active=!0,this.Backpack.node.zIndex=999,this.Backpack.start(),this.equip_ui.active=!1,this.createEquip()}},createEquip:function(){for(var t in this.hand.removeAllChildren(),this.weapon.removeAllChildren(),this.head.removeAllChildren(),this.body.removeAllChildren(),this.Hero.ATK=50,this.Hero.DEF=20,this.equip_json){var i=this.equip_json[t].name,s=this.G.getItem(i),e=this.equip_json[t].effect;switch(e=Number(e),this.equip_json[t].part){case"hand":s.parent=this.hand,this.hand.children[0].setPosition(cc.v2(0,0)),this.hand.children[0].on("click",this.equipClick,this),this.Hero.DEF+=e;break;case"head":this.head.addChild(s),this.head.children[0].setPosition(cc.v2(0,0)),this.head.children[0].on("click",this.equipClick,this),this.Hero.DEF+=e;break;case"weapon":this.weapon.addChild(s),this.weapon.children[0].setPosition(cc.v2(0,0)),this.weapon.children[0].on("click",this.equipClick,this),this.Hero.ATK+=e;break;case"body":this.body.addChild(s),this.body.children[0].setPosition(cc.v2(0,0)),this.body.children[0].on("click",this.equipClick,this),this.Hero.DEF+=e}}},btncancelClick:function(t){t.target.parent.active=!1,t.target.parent==this.node&&(this.equip_ui.active=!1)},errDisplay:function(t){this.error_ui.active=!0,this.error_ui.children[0].getComponent(cc.Label).string=t}}),cc._RF.pop()},{}],game1:[function(t,i,s){"use strict";cc._RF.push(i,"92775TqoaJBxacvziZUWYfX","game1"),cc.Class({extends:cc.Component,properties:{root:cc.Node,camera:cc.Node,hero:cc.Node,label:cc.Label,bg:cc.Node,bg2:cc.Node,tip:cc.Node,mm:cc.Node,backpack:cc.Node,attribute:cc.Node,mission:cc.Node,equip:cc.Node,m1_fab:{default:null,type:cc.Prefab},herohp_fab:{default:null,type:cc.Prefab},hit_fab:{default:null,type:cc.Prefab},m2_fab:{default:null,type:cc.Prefab},hh:cc.Prefab,mon_nu:0,gamepass_fab:cc.Prefab,gameover_fab:cc.Prefab},onLoad:function(){this.G=cc.find("Canvas/global").getComponent("global"),this.Hero=this.hero.getComponent("hero"),this.Mission=this.mission.getComponent("mission"),this.Equip=this.equip.getComponent("equip"),this.equip.active=!0,this.equip.setPosition(cc.v2(0,1e3)),this.herohp=cc.instantiate(this.herohp_fab),this.node.addChild(this.herohp),this.herohp.setPosition(cc.v2(-259,275)),this.gamepass=cc.instantiate(this.gamepass_fab),this.node.addChild(this.gamepass),this.gamepass.setPosition(cc.v2(0,1e3)),this.gameover=cc.instantiate(this.gameover_fab),this.node.addChild(this.gameover),this.gameover.active=!1,this.hp=this.herohp.getChildByName("hp"),this.mp=this.herohp.getChildByName("mp"),this.Hero.hp_show=this.hp,this.Hero.mp_show=this.mp,this.content=cc.find("Canvas/backpack/view"),this.item=cc.Node,this.root=cc.find("root").getComponent("root"),this.d=this.root.diffcult,this.loadTransform(),console.log("cur max\uff1a"+this.root.cur_lvl+" "+this.root.max_lvl)},start:function(){this.Mission.G=this.G,this.schedule(function(){this.tip.active=!1,console.log("---dialog tip closed--"),this.equip.active=!1},2,1),this.initMonster()},loadTransform:function(){var t=this.root;t.getJson("hero_json"),t.getJson("mis_json"),t.getJson("equip_json"),t.getJson("npc_json"),t.getJson("attri_json")},createMonsterPool:function(t,i){for(var s=Number(i),e=0;e<s;e++){var n=this.G.getMonster(t);n.name=t,n.getComponent("monster").init(),this.node.addChild(n);var o=4e3*Math.random()+550,c=200*Math.random()-200;n.setPosition(cc.v2(o,c)),console.log("---\u751f\u6210\u7b2c "+e+" \u4e2a"+t)}},initMonster:function(){"1"==this.root.cur_lvl?this.createMonsterPool("m0",this.mon_nu):"2"==this.root.cur_lvl?this.createMonsterPool("m1",this.mon_nu):"3"==this.root.cur_lvl?(this.createMonsterPool("m1",this.mon_nu),this.createMonsterPool("m0",this.mon_nu)):"4"==this.root.cur_lvl?this.createMonsterPool("m3",this.mon_nu):(this.createMonsterPool("m3",this.mon_nu),this.createMonsterPool("m1",this.mon_nu))},createHitPool:function(){this.hit=cc.Node,this.hit_pool=new cc.NodePool,this.hit_pool>0?this.hit=this.hit_pool.get():(this.hit=cc.instantiate(this.hit_fab),this.hit_pool.put(this.hit))},tipPosiUp:function(){this.tip.x=this.hero.x+90,this.tip.y=this.hero.y+90},nodePosiUpdate:function(){this.hero.x<4500&&this.hero.x>0&&(this.camera.x=this.hero.x,this.bg2.x=this.camera.x),this.herohp.setPosition(cc.v2(this.camera.x,-260)),this.backpack.x=this.camera.x-240,this.attribute.x=this.camera.x,this.backpack.x=this.camera.x,this.equip.x=this.camera.x,this.mission.x=this.camera.x,this.equip.active&&this.backpack.active&&(this.equip.x=this.camera.x-185,this.backpack.x=this.camera.x+220),this.bg.x>=2333?this.bg.x=2333:this.bg.x<=-2333&&(this.bg.x=-2333)},loadCity:function(){if(this.root.cur_lvl==this.root.max_lvl){var t=Number(this.root.max_lvl)+1;this.root.max_lvl=t}this.gamepass.setPosition(cc.v2(this.camera.x,0)),console.log("cur lvl:"+this.root.cur_lvl+"\n max lvl:"+this.root.max_lvl)},onDestroy:function(){},gameOver:function(){1==this.Hero.is_dead&&(this.gameover.active=!0,this.equip.zIndex=900,this.gameover.setPosition(cc.v2(this.camera.x,0)))},update:function(t){this.hero.x>4500&&Number(this.mon_nu)<1&&this.loadCity(),this.nodePosiUpdate(),this.tipPosiUp(),this.gameOver()}}),cc._RF.pop()},{}],gamePass:[function(t,i,s){"use strict";cc._RF.push(i,"3c76ew+alVJi6yJ4Ge1v0za","gamePass"),cc.Class({extends:cc.Component,properties:{},gameOverBtnClick:function(){cc.director.loadScene("city")},gamePassBtnClick:function(t,i){"1"==i?cc.director.loadScene("transform"):cc.director.loadScene("city")}}),cc._RF.pop()},{}],global:[function(t,i,s){"use strict";cc._RF.push(i,"068b8I0EkpPS7l5bESEGx/4","global"),cc.Class({extends:cc.Component,properties:{mon_prefab_list:{default:[],type:cc.Prefab},mission_prefab:cc.Prefab},onLoad:function(){this.item_pool=new Array,this.itemlist=new Array,this.asslist=new Array,this.monster_pool=new Array,this.mis_pool=new cc.NodePool,this.loadItem(),this.createMonPool(),this.createMisPool()},start:function(){},load:function(){cc.loader.loadResDir("items",function(t,i){}.bind(this))},loadItem:function(){cc.loader.loadResDir("items",function(t,i){if(t)console.log(t);else for(var s in this.asslist=new Array,i){var e=i[s].name.trim().split("m")[1];this.asslist[e]=i[s],this.item_pool[e]=new cc.NodePool,this.itemlist[e]=cc.instantiate(i[s]),this.item_pool[e].put(this.itemlist[e]),this.item_pool[e].name="item_pool"+e}}.bind(this))},getItem:function(t){t=t.trim().split("m")[1];var i=null;for(var s in this.item_pool)if(s==Number(t)){var e=this.item_pool[s];i=e.size()>0?e.get():cc.instantiate(this.asslist[s]);break}return null==i&&console.log("get error the item: item"+t),i},putItem:function(t){var i=Number(t.name.trim().split("m")[1]);this.item_pool[i].put(t)},createMonPool:function(){for(var t in this.mon_prefab_list){var i=this.mon_prefab_list[t].name.split("m")[1];this.monster_pool[t]=new cc.NodePool,this.monster_pool[t].name="monster_pool"+i,this.monster_pool[t].put(cc.instantiate(this.mon_prefab_list[i]))}},getMonster:function(t){var i,s=t.trim().split("m")[1];for(var e in this.monster_pool)if(s==this.monster_pool[e].name.split("l")[1]){var n=this.monster_pool[e];i=n.size()>0?n.get():cc.instantiate(this.mon_prefab_list[e]);break}return null!=i?console.log("get the monster: "+t):console.log("get error the monster: "+t),i},putMonster:function(t){var i=t.name.trim().split("m")[1];for(var s in this.monster_pool){if(i==this.monster_pool[s].name.split("l")[1]){this.monster_pool[s].put(t);break}}},createMisPool:function(){this.mis_pool.put(cc.instantiate(this.mission_prefab))},getMisItem:function(){return this.mis_pool.size>0?this.mis_pool.get():cc.instantiate(this.mission_prefab)}}),cc._RF.pop()},{}],heroUi:[function(t,i,s){"use strict";cc._RF.push(i,"ef48eubFfpDPppIyZZA4IOQ","heroUi"),cc.Class({extends:cc.Component,properties:{backpack_pre:cc.Prefab,mission_pre:cc.Prefab,attribute_pre:cc.Prefab},start:function(){this.backpack=cc.find("Canvas/backpack"),this.Backpack=this.backpack.getComponent("backpack"),this.hero=cc.find("Canvas/hero"),this.Hero=this.hero.getComponent("hero"),this.attribute=cc.find("Canvas/attribute"),this.Attribute=this.attribute.getComponent("attribute"),this.mission=cc.find("Canvas/mission"),this.Mission=this.mission.getComponent("mission"),this.equip=cc.find("Canvas/equip"),this.Equip=this.equip.getComponent("equip")},btnClick:function(t,i){this.G=cc.find("Canvas/global").getComponent("global");var s=t.target.name.trim();if("btn_backpack"==s){if(this.backpack.active)return;this.backpack.active=!0,this.backpack.zIndex=900,this.Backpack.start()}else if("btn_hero"==s){if(console.log("btn_hero clicked"),this.attribute.active)return;this.attribute.active=!0,this.attribute.zIndex=900,this.Attribute.start()}else if("btn_mission"==s){if(this.mission.active)return;this.mission.active=!0,this.mission.getComponent("mission").start(),this.mission.zIndex=900}else{if(this.equip.active)return;this.equip.active=!0,this.equip.y=0,this.equip.getComponent("equip").start(),this.equip.zIndex=900}}}),cc._RF.pop()},{}],hero:[function(t,i,s){"use strict";cc._RF.push(i,"638c1y4kCdBpJdum0E2hiKC","hero"),cc.Class({extends:cc.Component,properties:{hero:cc.Node,exskill:cc.Node,hp_show:cc.Node,mp_show:cc.Node,item_tip:cc.Node,map:cc.Node,exskill1:cc.Node,ATK:0,DEF:0,ACC:0,AVD:0,CRT:0,EXP:0,speedx:0,speedy:0,HP:100,HP_MAX:100,MP:100,MP_MAX:100,GOLD:0,atk_m:cc.AudioClip,skill1_m:cc.AudioClip,skill2_m:cc.AudioClip},onLoad:function(){cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this),cc.director.getCollisionManager().enabled=!0,this.anim=this.node.getComponent(cc.Animation),this.G=cc.find("Canvas/global").getComponent("global"),this.city=cc.find("Canvas").getComponent("city"),this.root=cc.find("root").getComponent("root")},start:function(){this.pdirect="",this.heroui=cc.find("Canvas/herohp"),null!=this.heroui?console.log("find the heroui"):console.log("find heroui err!"),this.run=!1,this.attack=!1,this.left=!1,this.right=!1,this.up=!1,this.down=!1,this.cando=!1,this.move=!0,this.lock=!1,this.skill1=!1,this.skill2=!1,this.canmove=!1,this.attack_key=1,this.is_hurt=!1,this.is_damage=!1,this.is_attack=!1,this.is_dead=!1,this.anim_hurt_lock=!1,this.json=[],this.equip_json=[],this.attri_json=[],this.enemy=cc.Node,this.collx=0,this.colly=0,this.shark_nu=0,this.shark_key=!1,this.item=cc.Node,this.is_pickup=!1,this.items=new Array,this.cityInit()},cityInit:function(){null==this.root.getJson("attri_json")?(console.log("run jsonTest"),this.jsonTest()):(this.json=this.root.getJson("hero_json"),this.attri_json=this.root.getJson("attri_json"),this.equip_json=this.root.getJson("equip_json"),this.GOLD=this.root.getJson("gold"))},onDestroy:function(){cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),cc.systemEvent.off(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this)},actionTest:function(t){var i=cc.sequence(cc.fadeTo(.05,0),cc.fadeTo(.05,255)),s=cc.callFunc(function(){this.itemRandom(t),t.removeFromParent()}.bind(this));t.runAction(cc.sequence(cc.repeat(i,5),s))},itemRandom:function(t){var i="item"+this.numRandom(0,this.json.length),s=this.G.getItem(i);console.log("----rand item name:"+s.name),this.node.parent.addChild(s),s.active=!0,s.setPosition(cc.v2(t.x,t.y+50));var e=cc.jumpTo(.5,cc.v2(s.x+100,s.y-20),40,1);s.runAction(e)},numRandom:function(t,i){var s=Math.floor(Math.random()*(i-t+1)+t);return console.log("-----item rand:"+s),s},jsonTest:function(){this.json=[{name:"item7",nu:"5"},{name:"item8",nu:"5"},{name:"item0",nu:"1"}],this.attri_json=[{gold:"300"}],this.GOLD="1000",this.equip_json=[],this.mis_json=[]},onCollisionEnter:function(t,i){"barrier"==t.node.group&&0==i.tag&&(t.node.y-20>this.node.y&&(this.coll_border="top",this.colly=t.node.y-25),this.node.y>=t.node.y-20&&(this.coll_border="other",this.node.scaleX<0?this.collx=this.node.x+5:this.collx=this.node.x-5,this.colly=this.node.y)),"item"==t.node.group&&0==i.tag&&t.node.parent==this.node.parent&&(this.item_tip.active=!0,this.item_tip.setPosition(cc.v2(t.node.x,t.node.y+30)))},onCollisionStay:function(t,i){if(this.enemy=t.node,i.tag,t.tag,1==t.tag&&(this.is_hurt=!0),"item"==t.node.group&&0==i.tag&&t.node.parent==this.node.parent&&(this.item=t.node,this.is_pickup=!0),"barrier"==t.node.group)if(0==i.tag)t.node.y-20>this.node.y&&(this.coll_border="top",this.colly=t.node.y-25),this.node.y>=t.node.y+25&&(this.coll_border="bottom",this.colly=t.node.y+25),this.node.y<=t.node.y+30&&this.node.y>=t.node.y-20&&("top"==this.coll_border?this.node.setPosition(cc.v2(this.node.x,this.colly)):"other"==this.coll_border?this.node.setPosition(cc.v2(this.collx,this.colly)):"bottom"==this.coll_border&&this.node.setPosition(cc.v2(this.node.x,this.colly))),this.node.y>t.node.y+30&&(t.node.opacity=100);else if(this.is_attack){var s=t.node.name.trim();console.log("hit node name:"+s),"vat"!=s&&"tree2"!=s||this.actionTest(t.node)}},onCollisionExit:function(t,i){"barrier"==t.node.group&&(this.coll_border="",t.node.opacity=255),"monster"==t.node.group&&(this.is_hurt=!1,this.is_attack=!1),"item"==t.node.group&&t.node.parent==this.node.parent&&(this.item_tip.active=!1,this.is_pickup=!1)},heroAttackDamage:function(){this.is_attack=!0},hpAndMpUpdate:function(){this.HP>this.HP_MAX&&(this.HP=this.HP_MAX),this.MP>this.MP_MAX&&(this.MP=this.MP_MAX),this.hp_show.setContentSize(this.HP/this.HP_MAX*240,12.5),this.mp_show.setContentSize(this.MP/this.MP_MAX*240,12.5),this.HP<=0&&(this.HP=0,this.node.removeFromParent(),this.is_dead=!0),this.MP<=0&&(this.MP=100)},heroHurt:function(){this.is_damage&&(this.is_damage=!1,this.move=!1,this.lock=!0,this.right=this.left=this.up=this.down=!1,this.run=!1,this.skill1=!1,this.anim_hurt_lock=!0,this.enemy.x<this.node.x?this.node.scaleX=-1:this.node.scaleX=1,this.anim.play("hero_hurt"),this.anim.on("finished",function(){this.anim.play("hero_stand"),this.move=!0,this.lock=!1,this.anim_hurt_lock=!1},this))},gethurtDamage:function(){this.node.scaleX>0?this.node.x-=80:this.node.x+=80},onKeyDown:function(t){switch(t.keyCode){case cc.macro.KEY.right:this.right=!0,this.left=this.attack=!1,this.heroMove();break;case cc.macro.KEY.left:this.left=!0,this.right=this.attack=!1,this.heroMove();break;case cc.macro.KEY.up:this.up=!0,this.heroMove();break;case cc.macro.KEY.down:this.down=!0,this.heroMove();break;case cc.macro.KEY.x:this.heroAttack();break;case cc.macro.KEY.s:this.skill2=!0,this.heroAttack();break;case cc.macro.KEY.a:this.skill1=!0,this.heroAttack();break;case cc.macro.KEY.w:this.pickupItem();break;case cc.macro.KEY.u:(i=this.G.getMonster("m0")).parent=this.node.parent,i.getComponent("monster").init(),i.setPosition(cc.v2(this.node.x+100,this.node.y));break;case cc.macro.KEY.i:(i=this.G.getMonster("m1")).parent=this.node.parent,i.getComponent("monster").init(),i.setPosition(cc.v2(this.node.x+200,this.node.y));break;case cc.macro.KEY.o:var i;(i=this.G.getMonster("m3")).parent=this.node.parent,i.getComponent("monster").init(),i.setPosition(cc.v2(this.node.x+300,this.node.y));break;case cc.macro.KEY.m:cc.game.end()}},onKeyUp:function(t){switch(t.keyCode){case cc.macro.KEY.right:this.right=!1,this.heroMove();break;case cc.macro.KEY.left:this.left=!1,this.heroMove();break;case cc.macro.KEY.up:this.up=!1,this.heroMove();break;case cc.macro.KEY.down:this.down=!1,this.heroMove();break;case cc.macro.KEY.x:}},pickupItem:function(){if(this.is_pickup){console.log("pickup item name:"+this.item.name);var t=0;for(t=0;t<this.json.length;t++)if(this.json[t],this.json[t].name==this.item.name.trim()){this.json[t].nu=Number(this.json[t].nu)+1;break}if(t>=this.json.length){console.log("herojson do not the"+this.item.name.trim());var i={name:this.item.name.trim(),nu:"1"};this.json.push(i)}this.item_tip.active=!1;var s=cc.moveTo(.3,cc.v2(this.node.x,this.node.y+30)),e=cc.callFunc(function(){this.G.putItem(this.item)}.bind(this));this.item.runAction(cc.sequence(s,e))}},heroMove:function(){this.move&&(this.right||this.left||this.up||this.down?this.run||(this.anim.play("hero_run"),this.canmove=!0,this.run=!0,this.attack_key=1):(this.canmove=!1,this.anim.play("hero_stand"),this.run=!1))},extendSkill2:function(){var t,i=!1;this.node.scaleX>0?(i=!0,t=1,this.exskill.setPosition(cc.v2(this.node.x+100,this.node.y))):(i=!1,t=-1,this.exskill.setPosition(cc.v2(this.node.x-100,this.node.y))),this.callback=function(){i?(this.exskill.x+=18,this.exskill.scaleX=t,this.exskill.scaleY=t,t+=.03):(this.exskill.x-=18,this.exskill.scaleX=t,this.exskill.scaleY=-1*t,t-=.03),this.lock||(this.exskill.scalex=1,this.exskill.scaleY=1,this.exskill.active=!1,this.unschedule(this.callback))},this.skill2&&(this.exskill.active=!0,this.schedule(this.callback,.01))},extendSkill1:function(){this.exskill1.active=!0;var t=this.exskill1.getComponent(cc.Animation);this.node.scaleX>0?this.exskill1.scaleX=-1:this.exskill1.scaleX=1,t.play("skill1ex"),this.exskill1.setPosition(cc.v2(this.node.x-20,this.node.y-5)),t.on("finished",function(t){this.exskill1.active=!1},this)},heroAttack:function(){this.move=!1,this.right=this.left=this.up=this.down=!1,this.run=!1,this.lock||(this.skill2&&this.MP>=20?(this.attack=!1,cc.audioEngine.play(this.skill2_m,!1,1),this.anim.play("hero_skill2"),this.MP-=20,this.attack_key=1):this.skill1&&this.MP>=5?(this.attack=!1,cc.audioEngine.play(this.skill1_m,!1,1),this.anim.play("hero_skill1"),this.MP-=5,this.attack_key=1):(this.attack=!0,cc.audioEngine.play(this.atk_m,!1,1),1==this.attack_key?this.anim.play("hero_attack1"):2==this.attack_key?this.anim.play("hero_attack2"):3==this.attack_key?this.anim.play("hero_attack3"):4==this.attack_key&&this.anim.play("hero_attack4"),this.attack_key++,5==this.attack_key&&(this.attack_key=1)),this.lock=!0),this.anim.on("finished",function(t){this.is_attack=!1,this.move=!0,this.anim.play("hero_stand"),this.attack=!1,this.skill2=!1,this.skill1=!1,this.lock=!1},this)},heroSkill1Move:function(t){!this.skill1||this.skill2||this.attack||this.anim_hurt_lock||(this.node.scaleX>0?(this.hero.x+=this.speedx*t*10*1.5,this.exskill1.setPosition(cc.v2(this.node.x-20,this.node.y-5))):(this.hero.x-=this.speedx*t*10*1.5,this.exskill1.setPosition(cc.v2(this.node.x,this.node.y-5))))},tryToMove:function(t){this.move&&(this.right?(this.node.scaleX=1,this.hero.x+=this.speedx*t*10):this.left?(this.node.scaleX=-1,this.hero.x-=this.speedx*t*10):this.up?this.hero.y+=this.speedy*t*10:this.down&&(this.hero.y-=this.speedy*t*10))},borderControll:function(){this.node.x>=4950&&(this.node.x=4950),this.node.x<=-170&&(this.node.x=-170),this.node.y>=-100&&(this.node.y=-100),this.node.y<=-250&&(this.node.y=-250)},phoneUiClick:function(){},update:function(t){this.tryToMove(t),this.heroSkill1Move(t),this.borderControll(t),this.hpAndMpUpdate(t),this.heroHurt()}}),cc._RF.pop()},{}],mission:[function(t,i,s){"use strict";cc._RF.push(i,"2f357K2FbJJOJpcLLpPW3Gl","mission"),cc.Class({extends:cc.Component,properties:{mis_layout:cc.Node,mis_name:cc.Label,mis_content:cc.Label,reward_layout:cc.Node,gold_nu:cc.Label,mis_state:cc.Label},btncancelClick:function(t,i){t.target.parent.active=!1},onLoad:function(){this.global=cc.find("Canvas/global").getComponent("global"),this.city=cc.find("Canvas").getComponent("city"),this.root=cc.find("root").getComponent("root")},start:function(){this.G=this.global,null!=this.city&&(this.npc_json=this.city.npc_json),null!=this.root.getJson("npc_json")&&(this.npc_json=this.root.getJson("npc_json")),this.mis_json=[],this.setMisItem()},setMisItem:function(){console.log("----run the setmisitem");var t=0;for(var i in this.mis_layout.removeAllChildren(),this.npc_json){var s=this.npc_json[i].mission;for(var e in s){var n=s[e];if(console.log("misson state:"+n.state),"0"!=n.state){this.mis_json.push(n),console.log("misson json  :"+n.title);var o=this.G.getMisItem();o.children[0].getComponent(cc.Label).string=n.title,o.name=n.name,this.mis_layout.addChild(o),this.mis_layout.children[t].on("click",this.missionClick,this),t++}}}},missionClick:function(t){var i=t.target,s=(i.name.trim().split("n")[1],null);for(var e in this.mis_json)i.name.trim()==this.mis_json[e].name&&(console.log("find the mis"),s=this.mis_json[e]);"1"==s.state&&(this.mis_state.string="\u4efb\u52a1\u8fdb\u884c\u4e2d..."),"2"==s.state&&(this.mis_state.string="\u4efb\u52a1\u5df2\u5b8c\u6210\uff01"),"3"==s.state&&(this.mis_state.string="\u5956\u52b1\u5df2\u9886\u53d6\uff01"),this.mis_name.string=s.title,this.mis_content.string=s.content,this.gold_nu.string=s.gold,this.reward_layout.removeAllChildren();var n=s.reward;for(var e in n){var o=this.G.getItem(n[e].name);this.reward_layout.addChild(o)}}}),cc._RF.pop()},{}],monster:[function(t,i,s){"use strict";cc._RF.push(i,"352d4zKXwFL8o/WkkwdNok5","monster"),cc.Class({extends:cc.Component,properties:{hero:cc.Node,ATK:0,DEF:0,ACC:0,AVD:0,HP:0,HP_MAX:0,speedx:0,speedy:0,scale:.5},onLoad:function(){this.map=cc.find("Canvas/map1"),this.hero=cc.find("Canvas/hero"),this.Hero=this.hero.getComponent("hero"),this.anim=this.node.getComponent(cc.Animation),this.hp_show=this.node.getChildByName("hp"),this.hit=this.node.getChildByName("hit"),this.miss=this.node.getChildByName("miss"),this.hit.active=!1,this.miss.active=!1,this.schedule(this.aiController,2),this.G=cc.find("Canvas/global").getComponent("global"),this.game=cc.find("Canvas").getComponent("game1"),this.root=cc.find("root").getComponent("root")},start:function(){this.name=this.node.name.trim(),this.len=this.map.x-this.node.x,this.DEF=50,this.can_attack=!1,this.key=!1,this.can_walk=!1,this.is_attack=!1,this.is_hurt=!1,this.can_hurt=!1,this.can_attack_hero=!1,this.can_do=!1,this.collx=0,this.colly=0,this.ai_key=!1,this.ai_schedule_lock=!1,this.hurt_anim_key=!1,this.left=!1,this.right=!1,this.up=!1,this.down=!1,this.into_barrier=!1,this.find_the_hero=!0,this.hit_anim=this.hit.getComponent(cc.Animation),this.scaleSet();var t=this.root.diffcult;this.HP=100*(1+.1*(t-1)),this.DEF=50*(1+.1*(t-1)),this.ATK=50*(1+.1*(t-1)),console.log("m attri:"+this.HP+" "+this.DEF+" "+this.ATK)},onCollisionEnter:function(t,i){"barrier"==t.node.group&&0==i.tag&&(t.node.y-20>this.node.y&&(this.coll_border="top",this.colly=t.node.y-25),this.node.y>=t.node.y-20&&(this.coll_border="other",this.node.scaleX<0?this.collx=this.node.x+20:this.collx=this.node.x-20,this.colly=this.node.y))},onCollisionStay:function(t,i){0==i.tag&&("barrier"==t.node.group&&(t.node.y-20>this.node.y&&(this.coll_border="top",this.colly=t.node.y-25),this.node.y>=t.node.y+25&&(this.coll_border="bottom",this.colly=t.node.y+25),this.node.y<=t.node.y+30&&this.node.y>=t.node.y-20&&("top"==this.coll_border?this.node.setPosition(cc.v2(this.node.x,this.colly)):"other"==this.coll_border?this.node.setPosition(cc.v2(this.collx,this.colly)):"bottom"==this.coll_border&&this.node.setPosition(cc.v2(this.node.x,this.colly)))),"hero"==t.node.group&&(this.can_hurt=!0)),i.tag,"skill"==t.node.group&&(this.can_hurt=!0,this.node.x=t.node.x,this.HP-=.01*this.Hero.ATK),"hero"==t.node.group&&(this.can_attack_hero=!0)},onCollisionExit:function(t,i){"barrier"==t.node.group&&(this.coll_border=null,this.into_barrier=!1),"hero"!=t.node.group&&"skill"!=t.node.group||(this.can_hurt=!1,this.can_attack_hero=!1,this.key=!1)},scaleSet:function(){"m3"==this.name&&(this.scale=1)},aiController:function(){if(!this.is_hurt){var t;if(this.into_barrier)if(this.find_the_hero)console.log("find the hero"),(t=Math.random())<.6?(this.right=this.left=this.down=!1,this.up=!0,console.log(this.name+"into the barrier -> turn up")):(this.right=this.left=this.up=!1,this.down=!0,console.log(this.name+"into the barrier -> turn down"));else(t=Math.random())<.4?(this.down=this.left=this.up=!1,this.left=!0,console.log(this.name+"into the barrier -> turn left")):t<.7&&(this.down=this.left=this.up=!1,this.right=!0,console.log(this.name+"into the barrier -> turn right"));if("m1"==this.name)if(this.node.y>=-80||this.node.y<=-250)(t=Math.random())<.6?(this.right=this.up=this.down=!1,this.left=!0,console.log(this.name+"into the border -> turn up")):(this.down=this.left=this.up=!1,this.right=!0,console.log(this.name+"into the border -> turn down"))}},move:function(t){var i=this.node.x,s=this.node.y;if(!this.is_hurt){var e=this.scale;"m3"==this.name&&(e=-this.scale),this.left&&(this.node.scaleX=e,i-=this.speedx*t*10),this.right&&(this.node.scaleX=-e,i+=this.speedx*t*10),this.up&&(this.node.scaleX=-e,s+=this.speedy*t*10),this.down&&(this.node.scaleX=-e,s-=this.speedy*t*10),this.node.setPosition(cc.v2(i,s))}},findHero:function(){var t=this.hero.x,i=this.hero.y,s=this.node.x,e=this.node.y;this.key=!1,s<t-70&&s>t-300?(this.find_the_hero=!0,this.into_barrier||(this.left=this.up=this.down=!1,this.right=!0)):s>t+70&&s<t+300?(this.find_the_hero=!0,this.into_barrier||(this.right=this.up=this.down=!1,this.left=!0)):s>=t-70&&s<=t+70?(this.find_the_hero=!0,t>s?"m3"==this.name?this.node.scaleX=1:this.node.scaleX=-.5:"m3"==this.name?this.node.scaleX=-1:this.node.scaleX=.5,e<i+30?(this.left=this.right=this.down=!1,this.up=!0):e>i+10&&(this.left=this.up=this.right=!1,this.down=!0),e<i+30&&e>i+10&&(this.left=this.up=this.right=!1,this.down=!1,this.key=!0)):this.find_the_hero=!1},m1AttackDamage:function(){Math.random()<=this.ACC-this.Hero.AVD&&this.Hero.is_hurt&&this.can_attack_hero?(this.is_attack=!0,this.Hero.HP-=this.ATK-this.Hero.DEF,this.Hero.is_damage=!0,this.Hero.is_hurt=!1):this.is_attack=!1},monsterAttackDamage:function(){var t=Math.random();console.log("---random:"+t),t<=this.ACC-this.Hero.AVD&&this.Hero.is_hurt&&this.can_attack_hero?(console.log("---acc:"+(this.ACC-this.Hero.AVD)),this.is_attack=!0,this.Hero.HP-=this.ATK-this.Hero.DEF,this.Hero.is_damage=!0,this.Hero.is_hurt=!1):(console.log(this.node.name+" miss"),this.is_attack=!1)},attack:function(){this.is_hurt||(this.key?(this.can_walk=!0,this.can_attack||(this.can_attack=!0,this.can_do||(this.can_do=!0,this.call=function(){this.animPlay("attack")},this.schedule(this.call,2)))):(this.unschedule(this.call),this.can_do=!1,this.can_attack=!1))},walk:function(){this.can_walk||(this.animPlay("walk"),this.can_walk=!0,this.anim.on("finished",function(t){this.can_walk=!1},this))},hpUpdate:function(){this.hp_show.setContentSize(this.HP/this.HP_MAX*200,15),this.HP<=0&&this.dead()},init:function(){this.onLoad(),this.start(),this.is_hurt=!1,this.hit.active=!1,this.miss.active=!1,this.animPlay("walk")},dead:function(){var t="item"+Math.floor(12*Math.random()),i=this.G.getItem(t);console.log("----rand item name:"+i.name),this.node.parent.addChild(i),console.log("------parent:"+this.node.parent.name),i.active=!0,i.setPosition(cc.v2(this.node.x,this.node.y+50));var s=cc.jumpTo(.5,cc.v2(i.x+100,i.y-20),40,1);i.runAction(s),this.G.putMonster(this.node),this.game.mon_nu--},hurt:function(){if(this.can_hurt&&this.Hero.is_attack)if(Math.random()<=this.Hero.ACC-this.AVD)this.can_attack=this.can_walk=!0,this.hurt_anim_key||(this.animPlay("hurt"),this.hurt_anim_key=!0,this.anim.on("finished",function(){this.hurt_anim_key=!1,this.can_attack=this.can_walk=!1},this)),this.hit.active=!0,this.hit.zIndex=999,this.hero.scaleX>0?(this.node.x+=30,this.hit.setPosition(cc.v2(-20,20))):(this.node.x-=30,this.hit.setPosition(cc.v2(-20,20))),this.hit_anim.play("hit"),this.hit_anim.on("finished",function(){this.hit.active=!1},this),this.Hero.attack&&(this.is_hurt=!0,this.Hero.ATK>=this.DEF&&(this.HP-=this.Hero.ATK-this.DEF),this.schedule(function(){this.is_hurt=!1},1,1)),this.Hero.skill1&&(this.is_hurt=!0,this.HP-=this.Hero.ATK+10-this.DEF,this.schedule(function(){this.is_hurt=!1},1.5,1)),this.Hero.skill2;else{this.hit_anim.stop("hit"),this.is_hurt=!1,this.hit.active=!1,this.miss.active=!0,this.miss.zIndex=999,this.hero.scaleX>0?(this.miss.scaleX=2,this.miss.setPosition(cc.v2(-20,20))):(this.miss.scaleX=-2,this.miss.setPosition(cc.v2(-20,20)));var t=0;this.callback=function(){this.miss.y+=2,30==(t+=1)&&(this.miss.active=!1,this.unschedule(this.callback))},this.schedule(this.callback,.01)}},positionUPdate:function(){"m1"==this.name&&(this.node.y>=-80&&(this.node.y=-80),this.node.y<=-250&&(this.node.y=-250)),this.name,this.hero.x>=180?this.Hero.right:this.hero.x<=-385&&this.Hero.left&&this.map.x},animPlay:function(t){t=this.node.name.trim()+"_"+t,this.anim.play(t)},update:function(t){this.positionUPdate(),this.hpUpdate(),this.hurt(),this.is_hurt||(this.findHero(),this.move(t),this.walk(),this.attack())}}),cc._RF.pop()},{}],npc_mission:[function(t,i,s){"use strict";cc._RF.push(i,"7fc61Ei5MNO+rqWIK5LZKvs","npc_mission"),cc.Class({extends:cc.Component,properties:{mission_layout:cc.Node,hero:cc.Node,mission_ui:cc.Node,mis_name:cc.Label,mis_content:cc.Label,reward_layout:cc.Node,gold_nu:cc.Label,btnok:cc.Node,mis_state:cc.Label},onLoad:function(){this.city=cc.find("Canvas").getComponent("city"),this.backpack=cc.find("Canvas/backpack"),this.Backpack=this.backpack.getComponent("backpack"),this.Hero=this.hero.getComponent("hero"),this.mission_json=null},start:function(){this.npc=this.city.npc,this.mis_complete=new Array,this.G=this.city.G,this.npc_json=this.city.npc_json,this.hero_json=null,this.gold=null,this.mission_ui.active=!1,this.curr_mis=cc.Node,this.mis_state.active=!1,this.createMission()},createMission:function(){var t=this.npc.name.trim().split("c")[1];this.mission_json=this.npc_json[t].mission;var i=0;for(var s in this.mission_layout.removeAllChildren(),this.mission_json){var e=this.G.getMisItem();e.children[0].getComponent(cc.Label).string=this.mission_json[s].title,e.name=this.mission_json[s].name,this.mission_layout.addChild(e),this.mission_layout.children[i].on("click",this.missionClick,this),i++}},missionClick:function(t){this.mission_ui.active=!0,this.mis_state.active=!1,this.curr_mis=t.target;var i=this.curr_mis.name.trim().split("n")[1];console.log("-----click mission:"+this.curr_mis.name),this.mis_name.string=this.mission_json[i].title,this.mis_content.string=this.mission_json[i].content,this.gold_nu.string=this.mission_json[i].gold,this.mis_complete[i]=this.mission_json[i].state,"0"==this.mis_complete[i]?(this.mis_state.active=!1,this.mis_state.string="",this.btnok.active=!0):"1"==this.mis_complete[i]?(this.mis_state.active=!0,this.btnok.active=!1,this.mis_state.string="\u4efb\u52a1\u8fdb\u884c\u4e2d..."):"2"==this.mis_complete[i]?(this.mis_state.active=!0,this.btnok.active=!0,this.btnok.children[0].getComponent(cc.Label).string="\u9886\u53d6\u5956\u52b1",this.mis_state.string=""):(this.mis_state.active=!0,this.btnok.active=!1,this.mis_state.string="\u5956\u52b1\u5df2\u9886\u53d6"),console.log("-------state string:"+this.mis_state.string),this.reward_layout.removeAllChildren();var s=this.mission_json[i].reward;for(var e in s){var n=this.G.getItem(s[e].name);this.reward_layout.addChild(n)}},btncancelClick:function(t){t.target.parent==this.node&&(this.mission_ui.active=!1),t.target.parent.active=!1},btnokClick:function(t){var i=t.target,s=this.curr_mis.name.trim().split("n")[1],e=this.mission_json[s].state;"2"==e&&(this.getReward(this.mission_json[s]),this.mis_state.string="\u5956\u52b1\u5df2\u9886\u53d6",this.mission_json[s].state="3"),"0"==e&&(this.mission_json[s].state="1",i.active=!1,this.mis_state.active=!0,this.mis_state.string="\u4efb\u52a1\u8fdb\u884c\u4e2d")},getReward:function(t){var i=t.gold,s=this.Hero.json,e=0;for(var n in t.reward){for(e=0;e<s.length;e++)if(t.reward[n].name==s[e].name){s[e].nu=Number(s[e].nu)+1;break}if(e>=s.length){var o={name:t.reward[n].name,nu:"1"};s.push(o)}}this.Hero.GOLD=Number(this.Hero.GOLD)+Number(i),this.btnok.active=!1}}),cc._RF.pop()},{}],phone_ui:[function(t,i,s){"use strict";cc._RF.push(i,"89c4fwz+StLKrOaHT5WHnAa","phone_ui"),cc.Class({extends:cc.Component,properties:{btn_up:cc.Node,btn_down:cc.Button},onLoad:function(){this.node.zIndex=999,this.direction="",this.Hero=cc.find("Canvas/hero").getComponent("hero"),this.Hero.pdirect=this.direction,this.node.on("touchstart",this.onEventStart,this),this.node.on("touchmove",this.onEventMove,this),this.node.on("touchcancel",this.onEventCancel,this),this.node.on("touchend",this.onEventEnd,this)},onEventStart:function(t){var i=t.getLocation(),s=t.target.name.split("_")[1];this.direction=s,console.log("start Event \n worldPoint=",i)},onEventCancel:function(t){var i=t.getLocation();console.log("start Event \n worldPoint=",i)},onEventEnd:function(t){var i=t.getLocation();console.log("end Event \n worldPoint=",i)},start:function(){}}),cc._RF.pop()},{}],root:[function(t,i,s){"use strict";cc._RF.push(i,"2f4d8UnbCNA5rG5phjnE70c","root"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){cc.game.addPersistRootNode(this.node),this.cur_lvl="1",this.max_lvl="1"},start:function(){this.music_play=null,this.hero_json=null,this.attri_json=null,this.equip_json=null,this.npc_json=null,this.mis_json=null,this.gold=null},setJson:function(t,i,s){this.start(),this.hero_json=t.json,this.gold=t.GOLD,this.attri_json=t.attri_json,this.equip_json=t.equip_json,this.mis_json=i.mis_json,null!=s&&(this.npc_json=s.npc_json)},getJson:function(t){var i=null;switch(t){case"hero_json":i=this.hero_json;break;case"equip_json":i=this.equip_json;break;case"mis_json":i=this.mis_json;break;case"npc_json":i=this.npc_json;break;case"attri_json":i=this.attri_json;break;case"gold":i=this.gold;break;case"diffcult":i=this.diffcult;break;case"music_play":i=this.music_play}return i},saveGame:function(){cc.director.end()}}),cc._RF.pop()},{}],shop:[function(t,i,s){"use strict";cc._RF.push(i,"046809Rg1tMOb9Q6tAnueEU","shop"),cc.Class({extends:cc.Component,properties:{item_layout:cc.Node,head:cc.Node,input:cc.EditBox,btn_buy:cc.Button,btn_cancel:cc.Button,item_pic:cc.Node,item_name:cc.Label,total_price:cc.Label,unit_price:cc.Label,err:cc.Node,backpack:cc.Node,hero:cc.Node},onLoad:function(){this.city=cc.find("Canvas").getComponent("city"),this.Backpack=this.backpack.getComponent("backpack"),this.Hero=this.hero.getComponent("hero")},start:function(){this.item=cc.Node,this.npc=null,this.G=this.city.G,this.npc_item=new Array,this.npc_json=this.city.npc_json,this.createItemList()},createItemList:function(){for(var t in this.npc_json)this.npc_item[t]=this.npc_json[t].item},setItem:function(t){var i=t.split("c")[1];i=Number(i);var s=0;for(var e in this.item_layout.removeAllChildren(),this.npc_item[i]){console.log("npc itemlist--\x3ename:"+this.npc_item[i][e].name);var n=this.npc_item[i][e].name.trim(),o=this.G.getItem(n);this.item_layout.addChild(o),this.item_layout.children[s].on("click",this.itemClick,this),s++}},setValue:function(t,i){switch(t.trim()){case"head":this.head.getComponent(cc.Sprite).spriteFrame=i;break;case"item_pic":this.item_pic.getComponent(cc.Sprite).spriteFrame=i;break;case"item_name":this.item_name.string=i;break;case"unit_price":this.unit_price.string="\u5355\u4ef7:"+i;break;case"npc":this.npc=i;break;case"clear":this.item_pic.getComponent(cc.Sprite).spriteFrame=null,this.unit_price.string="\u5355\u4ef7:",this.input.string="",this.total_price.string="\u603b\u4ef7:",this.item_name.string=""}},itemClick:function(t,i){console.log("-----item click:"+t.target.name),this.item=t.target,this.setValue("clear"),this.setValue("item_pic",this.item.getComponent(cc.Sprite).spriteFrame),this.setValue("item_name",this.item.children[0].getComponent(cc.Label).string);var s=this.npc.split("c")[1],e=this.npc_json[s].item;for(var n in e)if(e[n].name==this.item.name.trim()){this.setValue("unit_price",e[n].unit);break}},btncancelClick:function(t,i){var s=t.target.parent;s.active=!1,s==this.node&&(this.Backpack.item_ui.children[3].active=!1)},btnbuyClick:function(t,i){var s=Number(this.Hero.GOLD),e=Number(this.total_price.string.split(":")[1]);if(console.log(" hero gold:"+s),console.log(" price:"+e),""==e)return this.err.active=!0,void(this.err.children[0].getComponent(cc.Label).string="\u8bf7\u8d2d\u4e70\u8f93\u5165\u6570\u91cf");if(!(e<=s))return this.err.active=!0,void(this.err.children[0].getComponent(cc.Label).string="\u60a8\u7684\u91d1\u5e01\u4e0d\u8db3");s-=e,this.err.active=!0,this.err.children[0].getComponent(cc.Label).string="\u8d2d\u4e70\u6210\u529f,\u5171\u82b1\u8d39 "+e+" \u91d1\u5e01",this.Hero.GOLD=s;var n=this.item.name.trim(),o=0;for(o=0;o<this.Hero.json.length;o++)if(this.Hero.json[o].name.trim()==n){var c=Number(this.Hero.json[o].nu);c+=Number(this.input.string),this.Hero.json[o].nu=c;break}o>=this.Hero.json.length&&this.Backpack.addItem(this.item,this.input.string),this.Backpack.backpackTest()},inputEnd:function(){var t=this.input.string;if(Number(t)){var i=this.unit_price.string.split(":")[1];i=Number(i)*Number(this.input.string),this.total_price.string="\u603b\u4ef7:"+i}else console.log("----input not nu"),this.err.active=!0,this.err.children[0].getComponent(cc.Label).string="\u8bf7\u8f93\u5165\u6570\u5b57",this.input.string="";console.log("input string:"+this.input.string)}}),cc._RF.pop()},{}],start:[function(t,i,s){"use strict";cc._RF.push(i,"d43e3yFRtNB+6bNFBQVKGeP","start"),cc.Class({extends:cc.Component,properties:{m1_fab:{default:null,type:cc.Prefab},btnok:{default:null,type:cc.Node},btnset:{default:null,type:cc.Node},btnok1:{default:null,type:cc.Node},btncancel:{default:null,type:cc.Node},setui:cc.Node,help_ui:cc.Node,btn_help:cc.Button,toggle_music:cc.Toggle,btn_music:cc.AudioClip},onLoad:function(){this.btnok.on("click",this.btnokClick,this),this.btnset.on("click",this.btnsetClick,this),this.btncancel.on("click",this.btncancelClick,this),this.root=cc.find("root").getComponent("root")},start:function(){cc.director.preloadScene("city"),this.diffcult="1",this.music_play="1"},btnokClick:function(t){console.log("btnok click"),this.btnMusicPlay(),t.target.parent==this.setui?(console.log("d and m:"+this.diffcult+"  "+this.music_play),t.target.parent.active=!1):t.target.parent.active=!1},btnsetClick:function(t){console.log("btnset click"),this.btnMusicPlay(),this.setui.active=!0,this.btn_help.active=!1},btncancelClick:function(t){console.log("btncancel click"),this.btnMusicPlay(),t.target.parent.active=!1,this.btn_help.active=!0},btnHelpClick:function(t){this.btnMusicPlay(),0==this.setui.active&&(this.help_ui.active=!0)},btnStartClick:function(t){this.btnMusicPlay(),cc.director.loadScene("story"),this.root.diffcult=this.diffcult,this.root.music_play=this.music_play},toggleClick:function(t){if(t.isChecked){var i=t.target.name;switch(console.log("tg name:"+i),i.split("e")[1]){case"1":this.music_play="1";break;case"2":this.music_play="2";break;case"3":this.diffcult="1";break;case"4":this.diffcult="2";break;case"5":this.diffcult="3"}}},btnMusicPlay:function(){cc.audioEngine.play(this.btn_music,!1,1)},btnEndClick:function(){cc.game.end()}}),cc._RF.pop()},{}],story:[function(t,i,s){"use strict";cc._RF.push(i,"5cd15rhn/ZLV67gCWW9/BIz","story"),cc.Class({extends:cc.Component,properties:{lable:{default:null,type:cc.Node},magic:cc.Node,bg:cc.Node,speed:0},onLoad:function(){},start:function(){this.schedule(function(){var t=cc.fadeTo(1,255),i=cc.callFunc(function(){this.magic.active=!0,this.schedule(function(){cc.director.loadScene("city")},2,1)}.bind(this));this.bg.runAction(cc.sequence(t,i))},4,1)},update:function(t){this.lable.y<20&&(this.lable.y+=this.speed)}}),cc._RF.pop()},{}],transform:[function(t,i,s){"use strict";cc._RF.push(i,"f1fe5/qxVxDabXcCYmdxDKZ","transform"),cc.Class({extends:cc.Component,properties:{hero:cc.Node,lock:cc.Prefab,lvl_list:{default:[],type:cc.Node},error_ui:cc.Node,lvl_ui:cc.Node,btn_music:cc.AudioClip},onLoad:function(){this.anim=this.hero.getComponent(cc.Animation),this.move_lock=!1,this.cur_lvl=2,this.lvl_index=null,this.root=cc.find("root").getComponent("root")},start:function(){this.loadTransform(),this.cur_lvl=this.root.max_lvl,this.init()},init:function(){for(var t=Number(this.cur_lvl),i=5;i>t;i--)this.lvl_list[i-1].children[1].active=!0},loadTransform:function(){var t=this.root;t.getJson("hero_json"),t.getJson("mis_json"),t.getJson("equip_json"),t.getJson("npc_json"),t.getJson("attri_json")},errDisplay:function(t){this.error_ui.active=!0,this.error_ui.zIndex=999,this.error_ui.children[0].getComponent(cc.Label).string=t},levelClick:function(t){this.btnMusicPlay();var i=t.target,s=i.name.trim();i.children[1].active?this.errDisplay("\u8be5\u5173\u5361\u672a\u89e3\u9501"):this.move_lock||(this.move_lock=!0,this.moveToPosi(i.x,i.y,s))},moveToPosi:function(t,i,s){var e=cc.moveTo(2,cc.v2(t,i));t>this.hero.x?(this.hero.scaleX=1,this.anim.play("right")):(this.hero.scaleX=-1,this.anim.play("right"));var n=cc.callFunc(function(){this.anim.play("default"),this.move_lock=!1,this.lvl_index=s.split("v")[1],this.lvl_ui.active=!0,this.lvl_ui.children[0].getComponent(cc.Label).string="\u786e\u5b9a\u8fdb\u5165\u7b2c "+this.lvl_index+" \u5173"}.bind(this));this.hero.runAction(cc.sequence(e,n))},btncancelClick:function(t){t.target.parent.active=!1},lvluiBtnClick:function(t){var i=t.target,s="game"+this.lvl_index;"btn1"==i.name.trim()?(this.root.cur_lvl=this.lvl_index,console.log("pre load "+s),cc.director.loadScene(s)):this.lvl_ui.active=!1},btnMusicPlay:function(){cc.audioEngine.play(this.btn_music,!1,1)}}),cc._RF.pop()},{}]},{},["attribute","backpack","city","endGame","equip","game1","gamePass","global","hero","heroUi","mission","monster","npc_mission","phone_ui","root","shop","start","story","transform"]);